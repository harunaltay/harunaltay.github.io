<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Untitled Document</title>
</head>

<body>
<p><strong><em>I need to write an InDesign Script</em></strong></p>
<hr>
<p>in English:</p>
<p>There are 19 full size books ~6000 page in total, and 23 small size books in InDesign. Below you see the screen picture of one page as a sample. This is &quot;Risale-i Nur&quot;, the Collection of Bediüzzaman Said Nursi (1878-1960). These books are modern/contemporary explanation and commentary of Kuran.</p>
<p>Türkçe:</p>
<p>Bu kitaplar kolleksiyonu, Bediüzzaman Said Nursi'nin (1878-1960) meşhur Risale-i Nur Külliyatıdır.Normal sayfa boyu ile 6000 sayfa olarak bilinir. Şu anda bizde olanı 19 adet büyük boy ve 23 adet küçük boy kitaptır. Şu anda bizde olan 19 adet büyük boy 6,000 sayfadan fazla gelmesi normal, çünkü bakın her sayfanın kenar sütununda bir de derkenar sözlük var, yani o sayfada geçen kelimelerin sözlüğü var. Bu külliyatı onlarca senedir Türkiye'de sayısını bilmediğim sayıda çok yayınevi basmaktadır.</p>
<p>&nbsp;</p>
<hr>
<p>A sample book Lem'alar, as an InDesign file:</p>
<p>Örnek kitap olarak, Lem'alar kitabı, InDesign formatında:</p>
<p><a href="Lem'alarFolder.rar">Sample Book: Lem'alar</a></p>
<p>&nbsp;</p>
<hr>
<p>&nbsp;</p>
<p><img src="Lemalar55.PNG" width="803" height="1134" alt=""/>
</p>
<hr>
<p>&nbsp;</p>
<p>in English:</p>
<p>We need a script to export each page of the each book into a single txt file in txt format. For example, if a book contains 900 page, we need to have 900 seperate .txt files one for each page. </p>
<p>(&quot;Hâşiye&quot; means &quot;footnote&quot;!)</p>
<p>The below, you see the .txt file content of the sample book page above.</p>
<p>Please be careful, text file has 4 parts in order, because, this spsific page has 4 parts in order.</p>
<p></p>
<p>Türkçe:</p>
<p>Yapılacak iş ve script: Bu yukarıdaki InDesign sayfası, aşağıadaki metin dosyasına çevrilecek. Kitapta bulunan her bir sayfa için bir adet metin dosyası olacak. </p>
<p>(Hâşiye, dipnot demektir)</p>
<p>Lütfen dikkat: üretilmiş metin dosyası sıralı 4 bölümden oluşuyor, çünkü orjinal sayfa da 4 bölümden oluşuyor.</p>
<hr>
<p><br>
  ---0---(1. Part)<br>
</p>
<p>Bu Tetimmeye İkinci Bir İzah HÂŞİYE<br>
  Şu âhir-i Feth’in işaret-i gaybiyesini teyid eden, hem Fatiha-i Şerife’deki sırat-ı müstakim ehli ve  صِرَاطَ الَّذ۪ينَ اَنْعَمْتَ عَلَيْهِمْ<br>
  ayetindeki murad kimler olduğunu beyan eden, hem ebedü'l-âbâdın pek uzun yolunda en nuranî, ünsiyetli, kesretli, cazibedar bir kafile-i rüfekayı gösteren ve ehl-i iman ve ashab-ı şuuru şiddetle o kafileye tebaiyet noktasında iltihak ve refakate mu’cizâne sevk eden şu ayet<br>
  فَاُولٰٓئِكَ مَعَ الَّذ۪ينَ اَنْعَمَ اللّٰهُ عَلَيْهِمْ مِنَ النَّبِيّ۪ينَ وَ الصِّدّ۪يق۪ينَ وَ الشُّهَدَٓاءِ وَ الصَّالِح۪ينَ وَحَسُنَ اُولٰٓئِكَ رَف۪يقًا<br>
  yine ahir-i Feth’in âhirki ayeti gibi, ilm-i belâgatte “maârîzü’l-kelâm” ve “müstetbeâtü’t-terâkîb” tabir edilen mana-yı maksuddan başka, işarî ve remzî manalarla Hulefa-i Erbaa ve beşinci halife olan Hazret-i Hasan’a (ra) işaret ediyor, gaybî umurdan birkaç cihette haber veriyor. Şöyle ki: <br>
  Nasıl ki şu ayet, mana-yı sarihi ile nev-i beşerde niam-ı âliye-i İlâhiyeye mazhar olan, ehl-i sırat-ı müstakim olan kafile-i enbiya ve taife-i sıddıkîn ve cemaat-i şüheda ve enva-ı sâlihîn ve sınıf-ı Tâbiîn, muhsinîn olduğunu ifade ettiği gibi; âlem-i İslâm’da dahi o taifelerin en ekmeli ve en efdali bulunduğunu ve Nebî-i Ahirzamanın sırr-ı veraset-i nübüvvetten teselsül eden taife-i verese-i enbiya ve Sıddık-ı Ekber’in maden-i sıddıkıyetinden teselsül eden kafile-i sıddıkîn ve hulefa-i selâsenin şehadet mertebesiyle merbut bulunan kafile-i şüheda,<br>
  وَالَّذ۪ينَ اٰمَنُوا وَعَمِلُوا الصَّالِحَاتِ sırrıyla bağlanan cemaat-i salihîn ve قُلْ اِنْ كُنْتُمْ تُحِبُّونَ اللّٰهَ فَاتَّبِعُون۪ى يُحْبِبْكُمُ اللّٰهُ sırrını imtisal eden ve Sahabelerin ve Hulefa-i Raşidînin refakatinde giden esnaf-ı Tabiîni ihbar-ı gaybî nev’inden gösterdiği gibi,<br>
</p>
<p>---0--- (2. Part)</p>
<p>HÂŞİYE: Kardeşlerim her ikisini faydalı bulmasından, iki izahı beraber kaydetmişler. Yoksa biri kâfi idi.</p>
<p>---0--- (3. Part)</p>
<p>1. Kendilerine nimet ve ihsanda bulunduklarının yoluna... (Fatiha Suresi: 7.)<br>
  2. İşte onlar, Allah’ın kendilerine pek büyük nimetler bağışladığı peygamberler, sıddıklar, şehidler ve salih kimselerle beraberdirler. Onlar ise ne güzel arkadaşlardır! (Nisâ Suresi: 69.)<br>
  3. İman eden ve güzel işler yapanlar. (Bakara Suresi: 82.)<br>
  4. De ki: Eğer Allah’ı seviyorsanız bana uyun ki, Allah da sizi sevsin. (Âl-i İmran Suresi: 31.)</p>
<p>---0--- (4. Part)</p>
<p>ahir-i Fetih: Fetih Suresinin sonu.<br>
  ashab-ı şuur: şuurlu kimseler.<br>
  ebedü'l-âbâd: ahiret, ebedî hayat.<br>
  enva-i salihîn: dinin emir ve yasaklarını eksiksiz olarak yerine getirenler.<br>
  Hulefa-i Erbaa: dört büyük halife: Hz. Ebu Bekir, Hz. Ömer, Hz. Osman, Hz. Ali.<br>
  hulefa-i selâse: Hz. Ali’den önceki üç büyük halife.<br>
  ihbar-ı gaybî: bilinmeyen ve görünmeyen şeyler hakkında gelen.<br>
  ilm-i belâgat: belâgat ilmi, sözü yerinde ve güzel söylemenin kurallarını konu eden ilim.<br>
  iltihak: katılma.<br>
  imtisal: emre tamamen uyma.<br>
  kafile-i enbiya: peygamberlerin meydana getirdiği topluluk.<br>
  kafile-i rüfeka: arkadaşlar kafilesi.<br>
  kafile-i sıddıkîn: sadık ve doğru kimseler grubu.<br>
  kafile-i şüheda: şehidler kafilesi, topluluğu.<br>
  kesretli: çok sayıda.<br>
  maârîzü’l-kelâm: bir sözün asıl manası dışında, gizli başka manayı ifade etmesi, başka manaların istenmesi.<br>
  maden-i sıddıkıyet: özü, sözü doğru olmanın, sadakatin kaynağı.<br>
  mana-yı maksud: kasdedilen, hedeflenen mana.<br>
  merbut: bağlı.<br>
  muhsinîn: muhsinler, iyilik yapanlar.<br>
  müstetbeâtü’t-terâkîb: bir sözdeki doğrudan kasdedilen mana yerine dolaylı manaların dikkate alınması.<br>
  Nebî-i Ahirzaman: kıyametten önce gönderilen en son Peygamber Hz. Muhammed (asm)<br>
  niam-ı âliye-i İlâhiye: Allah’ın yüce ve âli nimetleri.<br>
  remzî: işaretle, dolaylı olarak.<br>
  Sıddık-ı Ekber: en büyük doğrulayıcı; Hz. Ebu Bekir.<br>
  sınıf-ı Tâbiîn: Hz. peygamberin Sahabeleriyle görüşmüş, onlardan ders almış olan Müslümanların topluluğu.<br>
  sırr-ı veraset-i nübüvvet: Peygamberlik vârisliği sırrı, hikmeti, aslı esası.<br>
  taife-i sıddıkîn: daima doğruluk üzere, Allah’a ve peygambere çok sadık olanların oluşturduğu topluluk.<br>
  taife-i verese-i enbiya: Peygamberlerin vârisleri olan âlimler topluluğu.<br>
  tebaiyet: tâbi olma, uyma.<br>
  umur: işler, gelişmeler, hususlar.</p>
<p>---0---</p>
<p></p>
<hr>
<p>Aşağıdaki kodları ben yazdım.</p>
<p>I wrote the codes below.</p>
<hr>
<p>Sayfa.jsx</p>
<div>
  <div>var document = app.activeDocument;</div>
  <div>var pages = document.pages;</div>
  <br>
  <div>// var page = pages[100];</div>
  <div>// var page = pages[54];</div>
  <div>// var page = pages[58];</div>
  <div>var page = pages[17];</div>
  <br>
  <div>alert(page.textFrames.length);</div>
  <br>
  <div>alert(page.textFrames[0].contents);</div>
  <div>alert(page.textFrames[1].contents);</div>
  <div>alert(page.textFrames[2].contents);</div>
  <div>alert(page.textFrames[3].contents);</div>
</div>
<hr>
<p>sayfalar_textFolder_sayilari_yazdir.jsx</p>
<div>
  <div>var document = app.activeDocument;</div>
  <div>var pages = document.pages;</div>
  <br>
  <div>var sayi = 0;</div>
  <div>var metin = "";</div>
  <br>
  <div>for (var i = 0; i &lt; pages.length; i++) {</div>
  <div>&#160; &#160; metin = metin + i + "=" + pages[i].textFrames.length + ", ";</div>
  <div>&#160; &#160; if (i==0) continue;</div>
  <div>&#160; &#160; if(i%20 == 0) metin = metin + "\n";</div>
  <div>&#160; } ;</div>
  <br>
  <div>alert(metin);</div>
  <br>
  <br>
  <div>// Preparing output path</div>
  <div>var scriptFolder = File.decode( File($.fileName).parent );</div>
  <div>var file = scriptFolder + "/dosya.txt";</div>
  <br>
  <div>var file2 = "D:/ExtendScriptFolder/dosya.txt";</div>
  <br>
  <div>// Writing</div>
  <div>writeTextFile( file2, metin);</div>
  <br>
  <br>
  <br>
  <div>// Set the third parameter to true if you don't want this to create the file if it doesn't already exist.</div>
  <div>// Returns false if file was not created. Doesn't account for write errors...</div>
  <div>function writeTextFile( filePath, textContent ) {</div>
  <div>&#160; </div>
  <div>&#160; &#160; var file = new File( filePath );</div>
  <br>
  <div>&#160; &#160; &#160; file.open('w'); // Opens a file for writing. If the file exists, its contents are destroyed. </div>
  <div>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; // If the file does not exist, creates a new, empty file.</div>
  <div>&#160; &#160; &#160; file.encoding = 'UTF8';</div>
  <div>&#160; &#160; &#160; file.write( textContent );</div>
  <div>&#160; &#160; &#160; file.close(); &#160; &#160; </div>
  <br>
  <div>&#160; }</div>
</div>
<hr>
<p>sayfalar_textFolder_muhtevalar_yazdir.jsx</p>
<div>
  <div>var document = app.activeDocument;</div>
  <div>var pages = document.pages;</div>
  <br>
  <div>// var sayi = 0;</div>
  <div>// var metin = "";</div>
  <br>
  <div>// for (var i = 0; i &lt; pages.length; i++) {</div>
  <div>// &#160; &#160; metin = metin + i + "=" + pages[i].textFrames.length + ", ";</div>
  <div>// &#160; &#160; if (i==0) continue;</div>
  <div>// &#160; &#160; if(i%20 == 0) metin = metin + "\n";</div>
  <div>// &#160; } ;</div>
  <br>
  <div>// alert(metin);</div>
  <br>
  <div>// var page = pages[100];</div>
  <div>// var page = pages[54];</div>
  <div>var page = pages[58];</div>
  <br>
  <div>alert(page.textFrames.length);</div>
  <br>
  <div>// alert(page.textFrames[0].contents);</div>
  <div>// alert(page.textFrames[1].contents);</div>
  <div>// alert(page.textFrames[2].contents);</div>
  <div>// alert(page.textFrames[3].contents);</div>
  <br>
  <div>var muhteva = "";</div>
  <br>
  <div>for (var index = 0; index &lt; page.textFrames.length; index++) {</div>
  <div>&#160; muhteva += page.textFrames[index].contents;</div>
  <div>&#160; muhteva += "\n\n ------- 0 -------\n\n";</div>
  <div>&#160; </div>
  <div>}</div>
  <br>
  <div>alert(muhteva);</div>
  <br>
  <div>var file = "D:/ExtendScriptFolder/muhteva.txt";</div>
  <br>
  <div>// Writing</div>
  <div>writeTextFile( file, muhteva);</div>
  <br>
  <br>
  <br>
  <div>// Set the third parameter to true if you don't want this to create the file if it doesn't already exist.</div>
  <div>// Returns false if file was not created. Doesn't account for write errors...</div>
  <div>function writeTextFile( filePath, textContent ) {</div>
  <div>&#160; </div>
  <div>&#160; &#160; var file = new File( filePath );</div>
  <br>
  <div>&#160; &#160; &#160; file.open('w'); // Opens a file for writing. If the file exists, its contents are destroyed. </div>
  <div>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; // If the file does not exist, creates a new, empty file.</div>
  <div>&#160; &#160; &#160; file.encoding = 'UTF8';</div>
  <div>&#160; &#160; &#160; file.write( textContent );</div>
  <div>&#160; &#160; &#160; file.close(); &#160; &#160; </div>
  <br>
  <div>&#160; }</div>
</div>
<hr>
<p>sayfalar_textFolder_muhtevalar_yazdir_coklu.jsx</p>
<div>
  <div>var document = app.activeDocument;</div>
  <div>var pages = document.pages;</div>
  <br>
  <div>// var page = pages[100];</div>
  <div>// var page = pages[54];</div>
  <div>var page = pages[58];</div>
  <br>
  <div>var muhteva = "";</div>
  <br>
  <div>alert(page.textFrames.length);</div>
  <br>
  <div>var sayi = 0;</div>
  <br>
  <div>for (var i = 0; i &lt; pages.length; i++) {</div>
  <div>&#160; muhteva ="";</div>
  <div>&#160; page = pages[i];</div>
  <div>&#160; for (var index = 0; index &lt; page.textFrames.length; index++) {</div>
  <div>&#160; &#160; muhteva += page.textFrames[index].contents;</div>
  <div>&#160; &#160; muhteva += "\n\n ------- 0 -------\n\n";</div>
  <div>&#160; &#160; </div>
  <div>&#160; };</div>
  <div>&#160; var file = "D:/ExtendScriptFolder/sayfalar/" + i + ".txt";</div>
  <br>
  <div>&#160; writeTextFile( file, muhteva); &#160; </div>
  <div>&#160; } ;</div>
  <br>
  <br>
  <div>// Set the third parameter to true if you don't want this to create the file if it doesn't already exist.</div>
  <div>// Returns false if file was not created. Doesn't account for write errors...</div>
  <div>function writeTextFile( filePath, textContent ) {</div>
  <div>&#160; </div>
  <div>&#160; &#160; var file = new File( filePath );</div>
  <br>
  <div>&#160; &#160; &#160; file.open('w'); // Opens a file for writing. If the file exists, its contents are destroyed. </div>
  <div>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; // If the file does not exist, creates a new, empty file.</div>
  <div>&#160; &#160; &#160; file.encoding = 'UTF8';</div>
  <div>&#160; &#160; &#160; file.write( textContent );</div>
  <div>&#160; &#160; &#160; file.close(); &#160; &#160; </div>
  <br>
  <div>&#160; }</div>
</div>
<hr>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
</body>
</html>
